!function(e){var t={};function a(s){if(t[s])return t[s].exports;var i=t[s]={i:s,l:!1,exports:{}};return e[s].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=e,a.c=t,a.d=function(e,t,s){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(a.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)a.d(s,i,function(t){return e[t]}.bind(null,i));return s},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=0)}([function(e,t,a){"use strict";a.r(t);class s{static activateListeners(e,t){}static getSheetData(e,t){return e}}const i={OPERATOR_EQUALS:0,OPERATOR_NOT_EQUALS:1,OPERATOR_GT:2,OPERATOR_LT:3,OPERATOR_GTE:4,OPERATOR_LTE:5},n={OR:0,AND:1};class r extends s{static activateListeners(e,t){e.find(".fatex__skill__reference__create").on("click",e=>this._onAddReference.call(this,e,t)),e.find(".fatex__skill__reference__change").on("change",e=>this._onChangeReference.call(this,e,t)),e.find(".fatex__skill__reference__remove").on("click",e=>this._onRemoveReference.call(this,e,t)),e.find(".fatex__skill__reference__setting").on("change",e=>this._onChangeSetting.call(this,e,t))}static async getSheetData(e,t){return e.skillReferences=this.getSkillReferences(t.entity),e.skillReferenceSettings=this.getSkillReferenceSettings(t.entity),e.availableSkillLevels=this.getAvailableSkillLevels(),e.availableOperators=this.getAvailableOperators(),e.availableConjunctions=this.getAvailableConjunctions(),t.entity.isOwned&&(e.availableActorSkills=this.getSkillsByActor(t.actor)),e}static async _onAddReference(e,t){e.preventDefault();const a=t.entity;await this.addSkillReference(a)}static async _onChangeReference(e,t){e.preventDefault();let a=e.currentTarget.value;const s=e.currentTarget.dataset,i=t.entity,n=s.index,r=s.field;"Number"===s.dtype&&(a=parseInt(a)),void 0!==n&&void 0!==r&&await this.changeSkillReference(i,n,r,a)}static async _onChangeSetting(e,t){e.preventDefault();let a=e.currentTarget.value;const s=e.currentTarget.dataset,i=t.entity,n=s.setting;"Number"===s.dtype&&(a=parseInt(a)),void 0!==n&&await this.setReferenceSetting(i,n,a)}static async _onRemoveReference(e,t){e.preventDefault();const a=e.currentTarget.dataset,s=t.entity,i=a.index;void 0!==i&&new Dialog({title:game.i18n.localize("FAx.Dialog.ReferenceRemove"),content:game.i18n.format("FAx.Dialog.ReferenceRemoveText"),default:"submit",buttons:{cancel:{icon:'<i class="fas fa-times"></i>',label:game.i18n.localize("FAx.Dialog.Cancel"),callback:()=>null},submit:{icon:'<i class="fas fa-check"></i>',label:game.i18n.localize("FAx.Dialog.Confirm"),callback:async()=>{await this.removeSkillReference(s,i)}}}},{classes:["fatex","fatex__dialog"]}).render(!0)}static async addSkillReference(e){const t=this.getSkillReferences(e),a=duplicate(t);a.push({skill:"",condition:0,operator:i.OPERATOR_GTE,default:0,action:0,argument:0,argument2:0,argument3:0}),await e.setFlag("fatex","skillReferences",a)}static async changeSkillReference(e,t,a,s){const i=this.getSkillReferences(e),n=duplicate(i),r=n[t];r[a]=s,n.splice(t,1,r),await e.setFlag("fatex","skillReferences",n)}static async removeSkillReference(e,t){const a=this.getSkillReferences(e),s=duplicate(a);s.splice(t,1),await e.setFlag("fatex","skillReferences",s)}static async setReferenceSetting(e,t,a){await e.setFlag("fatex","skillReferenceSettings."+t,a)}static getReferenceSetting(e,t,a){const s=e.getFlag("fatex","skillReferenceSettings."+t);return void 0===s?a:s}static getSkillReferences(e){return e.getFlag("fatex","skillReferences")||[]}static getSkillsByActor(e,t=!0){const a=duplicate(e).items.filter(e=>"skill"===e.type).map(e=>duplicate(e));return t&&a.sort((e,t)=>t.name-e.name),a}static getActorSkillById(e,t){const a=duplicate(e).items.filter(e=>e._id===t);if(a)return a[0]}static getAvailableSkillLevels(){const e=[];for(let t=0;t<=20;t++){const a=[];a.value=t,a.label="+"+t,e.push(a)}return e}static getAvailableOperators(){const e=[];for(let t in i){const a=[];a.value=i[t],a.label=game.i18n.localize("FAx.Item.Automation.Operators."+t),e.push(a)}return e}static getAvailableConjunctions(){const e=[];for(let t in n){const a=[];a.value=n[t],a.label=game.i18n.localize("FAx.Item.Automation.Conjunctions."+t),e.push(a)}return e}static checkSkillCondition(e,t,a=i.OPERATOR_GTE){const s=e.data.rank;switch(a){case i.OPERATOR_EQUALS:return s===t;case i.OPERATOR_NOT_EQUALS:return s!==t;case i.OPERATOR_GTE:return s>=t;case i.OPERATOR_GT:return s>t;case i.OPERATOR_LTE:return s<=t;case i.OPERATOR_LT:return s<t}return!1}static getSkillReferenceSettings(e){const t={};return t.conjunction=this.getReferenceSetting(e,"conjunction",n.OR),t}}class l{static get entityName(){return!1}static prepareItemData(e,t){return e}static activateActorSheetListeners(e,t){if(!this.entityName)throw new Error("A subclass of the BaseItem must provide an entityName field or implement their own _onItemAdd() method.");e.find(`.fatex__${this.entityName}__add`).click(e=>this._onItemAdd.call(this,e,t)),e.find(`.fatex__${this.entityName}__settings`).click(e=>this._onItemSettings.call(this,e,t)),e.find(`.fatex__${this.entityName}__delete`).click(e=>this._onItemDelete.call(this,e,t))}static getSheetData(e,t){return e}static getActorSheetData(e){return e}static activateListeners(e,t){}static _onItemAdd(e,t){if(e.preventDefault(),e.stopPropagation(),!this.entityName)throw new Error("A subclass of the BaseItem must provide an entityName field or implement their own _onItemAdd() method.");const a={name:this.defaultName,type:this.entityName};this.createNewItem(a,t)}static _onItemSettings(e,t){e.preventDefault(),e.stopPropagation();const a=e.currentTarget.dataset,s=t.actor.getOwnedItem(a.item);s&&s.sheet.render(!0)}static _onItemDelete(e,t){e.preventDefault(),e.stopPropagation();const a=e.currentTarget.dataset,s=t.actor.getOwnedItem(a.item);new Dialog({title:`${game.i18n.format("FAx.Dialog.EntityDelete")} ${s.name}`,content:game.i18n.format("FAx.Dialog.EntityDeleteText"),default:"submit",buttons:{cancel:{icon:'<i class="fas fa-times"></i>',label:game.i18n.localize("FAx.Dialog.Cancel"),callback:()=>null},submit:{icon:'<i class="fas fa-check"></i>',label:game.i18n.localize("FAx.Dialog.Confirm"),callback:async()=>{await t.actor.deleteOwnedItem(a.item)}}}},{classes:["fatex","fatex__dialog"]}).render(!0)}static createNewItem(e,t,a=!0){t.actor.createOwnedItem(e).then(e=>{if(!a)return;t.actor.getOwnedItem(e._id).sheet.render(!0)})}static get defaultName(){return this.entityName.charAt(0).toUpperCase()+this.entityName.slice(1)}}const c=0,o=1;class p extends l{static get entityName(){return"stunt"}static activateActorSheetListeners(e,t){super.activateActorSheetListeners(e,t),e.find(".fatex__stunt__toggle").click(e=>this._onToggleView.call(this,e,t))}static _onToggleView(e,t){e.preventDefault(),e.stopPropagation()}}const m=1,d=2;class g extends l{static get entityName(){return"stress"}static activateActorSheetListeners(e,t){super.activateActorSheetListeners(e,t),e.find(".fatex__stress__track__item__box").click(e=>this._onStressBoxToggle.call(this,e,t))}static prepareItemData(e,t){const a=parseInt(e.data.size);return e.boxes=[...Array(a).keys()].map(t=>{const a={};return a.isChecked=e.data.value&2**t,a.label=this._getBoxLabel(e,t),a}),e.fillers=a%4==0?[]:[...Array(4-e.data.size%4).keys()],e}static _getBoxLabel(e,t){return e.data.labelType===m?"1":e.data.labelType===d?e.data.customLabel.split(" ")[t]:t+1}static _getToggledStressValue(e,t){return e^2**t}static _onStressBoxToggle(e,t){e.preventDefault();const a=e.currentTarget.dataset,s=t.actor.getOwnedItem(a.item),i=a.index;if(s){const e=g._getToggledStressValue(s.data.data.value,i);s.update({"data.value":e})}}}const u={itemTypes:{stress:g,aspect:class extends l{static get entityName(){return"aspect"}static activateActorSheetListeners(e,t){super.activateActorSheetListeners(e,t),e.find(".fatex__aspect__input").on("blur",e=>this._onAspectTextChange.call(this,e,t))}static _onAspectTextChange(e,t){e.preventDefault();const a=e.currentTarget.dataset,s=t.actor.getOwnedItem(a.itemId),i=$(e.currentTarget).html();s.data.data.value!==i&&s&&s.update({"data.value":i})}},consequence:class extends l{static get entityName(){return"consequence"}static prepareItemData(e,t){return e.isConsequence=e.data.type===c,e.isCondition=e.data.type===o,t.isOwned&&(e.isDisabled=this.getDisabledState(t)),e}static activateActorSheetListeners(e,t){super.activateActorSheetListeners(e,t),e.find(".fatex__consequence__box").click(e=>this._onToggleCondition.call(this,e,t)),e.find(".fatex__consequence__input").on("blur",e=>this._onConsequenceTextChange.call(this,e,t))}static _onToggleCondition(e,t){e.preventDefault();const a=e.currentTarget.dataset,s=t.actor.getOwnedItem(a.item);s&&s.update({"data.active":!s.data.data.active})}static _onConsequenceTextChange(e,t){e.preventDefault();const a=e.currentTarget.dataset,s=t.actor.getOwnedItem(a.itemId),i=$(e.currentTarget).html();s.data.data.value!==i&&s&&s.update({"data.value":i})}static getDisabledState(e){let t=!1;const a=r.getSkillReferences(e),s=r.getReferenceSetting(e,"conjunction",n.OR);s===n.OR&&a.length&&(t=!0);for(const t of a){const a=r.getActorSkillById(e.actor,t.skill),i=void 0!==a&&r.checkSkillCondition(a,t.condition,t.operator);if(s===n.OR&&i)return!1;if(s===n.AND&&!i)return!0}return t}},skill:class extends l{static get entityName(){return"skill"}static activateActorSheetListeners(e,t){super.activateActorSheetListeners(e,t),e.find(".fatex__skill").click(e=>this._onRollSkill.call(this,e,t)),e.find(".fatex__skill__increment").click(e=>this._onSkillChangeRank.call(this,e,t,!0)),e.find(".fatex__skill__decrement").click(e=>this._onSkillChangeRank.call(this,e,t,!1))}static getActorSheetData(e){return e.options.enableColumns=e.skills.length>=8,e.options.addSkillFiller=e.options.enableColumns&&!!(e.skills.length%2),e}static prepareItemData(e,t){return e.data.isNegative=e.data.rank<0,e.data.isPositive=e.data.rank>=0,e.data.isNeutral=0===e.data.rank,e}static getSheetData(e){e.availableRanks=[];for(let t=0;t<=9;t++)e.availableRanks.push(t);return e}static _onSkillChangeRank(e,t,a){e.preventDefault(),e.stopPropagation();const s=e.currentTarget.dataset,i=t.actor.getOwnedItem(s.item);if(i){const e=i.data.data.rank;let t=0;t=a?e>=9?9:e+1:e<=-9?-9:e-1,i.update({"data.rank":t})}}static _onRollSkill(e,t){e.preventDefault();const a=e.currentTarget.dataset,s=t.actor.getOwnedItem(a.itemId);s&&this.rollSkill(t,s)}static async rollSkill(e,t){const a=this.prepareItemData(duplicate(t),t),s=parseInt(a.data.rank)||0,i=e.actor,n=new Roll("4dF").roll();let r={skill:a,rank:s,dice:this.getDice(n),total:this.getTotalString(n.total+s),ladder:this.getLadderLabel(n.total+s)},l={user:game.user._id,speaker:ChatMessage.getSpeaker({actor:i}),sound:CONFIG.sounds.dice,flags:{templateVariables:r}};l.content=await renderTemplate("systems/fatex/templates/chat/roll-skill.html",r),await ChatMessage.create(l)}static getDice(e){const t=[];return e.parts[0].rolls&&e.parts[0].rolls.forEach(e=>{const a={};a.value=e.roll,a.face=this.getDieFace(e.roll),t.push(a)}),e.terms&&e.terms[0].results.forEach(e=>{const a={};a.value=e.result,a.face=this.getDieFace(e.result),t.push(a)}),t}static getDieFace(e){return e>0?"+":e<0?"-":"0"}static getLadderLabel(e){return e>8&&(e=8),e<-4&&(e=-4),game.i18n.localize("FAx.Global.Ladder."+this.getTotalString(e))}static getLadderPrefix(e){return e<0?"-":"+"}static getTotalString(e){return this.getLadderPrefix(e).concat(Math.abs(e).toString())}},stunt:p,extra:class extends p{static get entityName(){return"extra"}static activateActorSheetListeners(e,t){super.activateActorSheetListeners(e,t),e.find(".fatex__extra__toggle").click(e=>this._onToggleView.call(this,e,t))}}},sheetComponents:{actor:{sortable:class extends s{static activateListeners(e,t){e.find(".fatex__sortable").each((e,a)=>{a.addEventListener("dragstart",e=>t._onDragStart.call(t,e),!1)}),e.find(".fatex__item__sort").mousedown(e=>this._onDragHandlerMouseDown.call(this,e)),e.find(".fatex__item__sort").mouseup(e=>this._onDragHandlerMouseUp.call(this,e))}static _onDragHandlerMouseDown(e){$(e.currentTarget).parents(".fatex__sortable").get(0).setAttribute("draggable","true")}static _onDragHandlerMouseUp(e){$(e.currentTarget).parents(".fatex__sortable").get(0).setAttribute("draggable","false")}},configuration:class extends s{static activateListeners(e,t){e.find(".fatex__sheet__action--import-core").click(e=>this._onImport.call(this,e,t,"core")),e.find(".fatex__sheet__action--import-condensed").click(e=>this._onImport.call(this,e,t,"condensed")),e.find(".fatex__sheet__action--import-accelerated").click(e=>this._onImport.call(this,e,t,"accelerated"))}static async _onImport(e,t,a){e.preventDefault();const s=t.actor,i=game.packs.find(e=>e.collection==="fatex.fate-"+a),n=await i.getContent();let r=duplicate(n);r.sort((e,t)=>e.flags.fatex.importSort-t.flags.fatex.importSort),await s.createOwnedItem(r)}}},item:{radio:class extends s{static activateListeners(e,t){e.find(".fatex__setting__radio").click(e=>this._onSettingsRadio.call(this,e,t))}static _onSettingsRadio(e,t){e.preventDefault();const a=e.currentTarget.dataset,s=a.name,i=t.entity;let n="";n="Number"===a.dtype?parseInt(a.value):a.value,i.update({[s]:n})}},rangeSlider:class extends s{static activateListeners(e,t){e.find(".fatex__setting__range__value").on("change",e=>this._onChangeRangeValue.call(this,e,t)),e.find(".fatex__setting__range__slider").on("input",e=>this._onChangeRangeSlider.call(this,e,t))}static _onChangeRangeSlider(e,t){e.preventDefault();e.currentTarget.previousElementSibling.value=e.currentTarget.value}static _onChangeRangeValue(e,t){e.preventDefault();e.currentTarget.nextElementSibling.value=e.currentTarget.value}},automation:r}},applications:{templateSettings:null,templatePicker:null}};class f extends FormApplication{static get defaultOptions(){const e=super.defaultOptions;return mergeObject(e,{title:game.i18n.localize("FAx.Settings.Templates.App.Title"),template:"/systems/fatex/templates/settings/template-actors.html",id:"template-actors",resizable:!0,classes:e.classes.concat(["fatex fatex__settings_sheet"]),width:920,height:500}),e}getData(e={}){let t=duplicate(game.actors.filter(e=>e.isTemplateActor));return t.forEach(e=>{e.stress=e.items.filter(e=>"stress"===e.type),e.aspects=e.items.filter(e=>"aspect"===e.type),e.skills=e.items.filter(e=>"skill"===e.type),e.consequences=e.items.filter(e=>"consequence"===e.type)}),{options:this.options,templateActors:t}}activateListeners(e){super.activateListeners(e),e.find(".fatex__template__create").click(e=>this._createTemplate.call(this,e)),e.find(".fatex__template__delete").click(e=>this._deleteTemplate.call(this,e)),e.find(".fatex__template__configure").click(e=>this._configureTemplate.call(this,e)),e.find(".fatex__template__duplicate").click(e=>this._duplicateTemplate.call(this,e))}async _configureTemplate(e){e.preventDefault(),e.stopPropagation();const t=e.currentTarget.dataset,a=game.actors.get(t.template);a&&a.sheet.render(!0)}async _deleteTemplate(e){e.preventDefault(),e.stopPropagation();const t=e.currentTarget.dataset,a=game.actors.get(t.template);a&&new Dialog({title:`${game.i18n.format("FAx.Dialog.EntityDelete")} ${a.name}`,content:game.i18n.format("FAx.Dialog.EntityDeleteText"),default:"submit",buttons:{cancel:{icon:'<i class="fas fa-times"></i>',label:game.i18n.localize("FAx.Dialog.Cancel"),callback:()=>null},submit:{icon:'<i class="fas fa-check"></i>',label:game.i18n.localize("FAx.Dialog.Confirm"),callback:async()=>{await a.delete(),this.render(!0),CONFIG.FateX.applications.templatePicker.render()}}}},{classes:["fatex","fatex__dialog"]}).render(!0)}async _createTemplate(e){e.preventDefault();const t={name:game.i18n.localize("FAx.Settings.Templates.New"),type:"character",flags:{fatex:{isTemplateActor:!0}}};await Actor.create(t,{renderSheet:!0}),this.render(!0),CONFIG.FateX.applications.templatePicker.render()}async _duplicateTemplate(e){e.preventDefault(),e.stopPropagation();const t=e.currentTarget.dataset,a=duplicate(game.actors.get(t.template));a&&(delete a._id,a.name=a.name+` (${game.i18n.localize("FAx.Settings.Templates.Copy")})`,await Actor.create(a,{renderSheet:!0}),this.render(!0),CONFIG.FateX.applications.templatePicker.render())}async _updateObject(e,t){}}class h extends f{static get defaultOptions(){const e=super.defaultOptions;return mergeObject(e,{title:game.i18n.localize("ACTOR.Create"),template:"/systems/fatex/templates/settings/template-actors-picker.html",id:"template-actor-picker",resizable:!0,classes:e.classes.concat(["fatex fatex__settings_sheet"]),width:1e3,height:430}),e}activateListeners(e){super.activateListeners(e),e.find(".fatex__template__choose").click(e=>this._chooseTemplate.call(this,e)),e.find(".fatex__template__empty").click(e=>this._emptyTemplate.call(this,e)),e.find(".fatex__template__header__settings").click(e=>this._openSettings.call(this,e))}async _openSettings(){CONFIG.FateX.applications.templateSettings.render(!0)}async _emptyTemplate(e){e.preventDefault(),e.stopPropagation();const t={name:game.i18n.localize("FAx.Template.Picker.Empty"),type:"character"};y._create(t,{renderSheet:!0}),this.close()}async _chooseTemplate(e){e.preventDefault(),e.stopPropagation();const t=e.currentTarget.dataset,a=duplicate(game.actors.get(t.template));a.flags.fatex.templateActor=a._id,delete a._id,delete a.flags.fatex.isTemplateActor,y._create(a,{renderSheet:!0}),this.close()}async _updateObject(e,t){}}class _ extends ActorSheet{static get defaultOptions(){const e=super.defaultOptions;return mergeObject(e,{classes:e.classes.concat(["fatex fatex__sheet"]),template:"systems/fatex/templates/actor/character.html",tabs:[{navSelector:".fatex__tabs__navigation",contentSelector:".fatex__tabs__content",initial:"skills"}],scrollY:[".desk__content"],width:860}),e}activateListeners(e){super.activateListeners(e);for(let t in CONFIG.FateX.itemTypes)CONFIG.FateX.itemTypes[t].activateActorSheetListeners(e,this);for(let t in CONFIG.FateX.sheetComponents.actor)CONFIG.FateX.sheetComponents.actor[t].activateListeners(e,this)}getData(){let e={owner:this.actor.owner,options:this.options,editable:this.isEditable,isTemplateActor:this.actor.isTemplateActor,isEmptyActor:!this.actor.items.size,config:CONFIG.FateX};e.actor=duplicate(this.actor.data),e.data=e.actor.data,e.items=this.actor.items.map(e=>e.data).sort(this._sortItems),e.stress=e.items.filter(e=>"stress"===e.type),e.aspects=e.items.filter(e=>"aspect"===e.type),e.skills=e.items.filter(e=>"skill"===e.type),e.stunts=e.items.filter(e=>"stunt"===e.type),e.extras=e.items.filter(e=>"extra"===e.type),e.consequences=e.items.filter(e=>"consequence"===e.type);for(let t in CONFIG.FateX.itemTypes)e=CONFIG.FateX.itemTypes[t].getActorSheetData(e,this);return e}_getHeaderButtons(){let e=super._getHeaderButtons();const t=game.user.isGM||this.actor.owner;return this.options.editable&&t&&(e=[{label:"Edit mode",class:"fatex-toggle-edit-mode",icon:"fas fa-edit",onclick:e=>this._onToggleEditMode(e)}].concat(e)),e}_sortItems(e,t){return(e.sort||0)-(t.sort||0)}_onToggleEditMode(e){e.preventDefault();const t=$(e.currentTarget).parents(".app");t.find(".window-content");t.toggleClass("fatex__helper--enable-editmode")}}class x extends _{}class y extends Actor{static async create(e,t={}){if(e._id)return super.create(e,t);CONFIG.FateX.applications.templatePicker.render(!0)}static async _create(e,t={}){return e.token=e.token||{},t.actorTemplate&&mergeObject(e,t.actorTemplate),mergeObject(e.token,{vision:!0,dimSight:30,brightSight:0,actorLink:!0,disposition:1},{overwrite:!1}),super.create(e,t)}render(e=!1,t={}){super.render(e,t);for(let e in CONFIG.FateX.applications)CONFIG.FateX.applications[e].render()}get _sheetClass(){return this.isTemplateActor?x:super._sheetClass}get isTemplateActor(){return!!this.getFlag("fatex","isTemplateActor")}get visible(){return!this.isTemplateActor&&super.visible}_onModifyEmbeddedEntity(e,t,a,s,i={}){super._onModifyEmbeddedEntity(e,t,a,s,i),"OwnedItem"===e&&this.items.forEach(e=>e.prepareData())}}class k extends _{}class b extends ItemSheet{static get defaultOptions(){const e=super.defaultOptions;return mergeObject(e,{classes:e.classes.concat(["fatex fatex__item_sheet"]),scrollY:[".desk__content"]}),e}getData(){let e=super.getData();e.isOwnedBy=!!this.actor&&this.actor.name,e=CONFIG.FateX.itemTypes[e.item.type].getSheetData(e,this);for(let t in CONFIG.FateX.sheetComponents.item)e=CONFIG.FateX.sheetComponents.item[t].getSheetData(e,this);return e}get template(){return`systems/fatex/templates/item/${this.item.data.type}-sheet.html`}activateListeners(e){super.activateListeners(e);for(let t in CONFIG.FateX.sheetComponents.item)CONFIG.FateX.sheetComponents.item[t].activateListeners(e,this);CONFIG.FateX.itemTypes[this.entity.type].activateListeners(e,this)}}class v extends b{}class S extends b{}class T extends b{}class A extends Item{prepareData(){super.prepareData();let e=this.data;CONFIG.FateX.itemTypes[e.type].prepareItemData(e,this)}}class O extends b{}class F extends b{}class D extends b{}class I{static ready(){CONFIG.FateX.applications.templateSettings=new f,CONFIG.FateX.applications.templatePicker=new h}static hooks(){Hooks.on("renderSidebarTab",(e,t,a)=>{if(!(e instanceof Settings&&game.user.isGM))return;t.find('button[data-action="configure"]').before(`\n                <button data-fatex="templates">\n                    <i class="fas fa-file-medical"></i> ${game.i18n.localize("FAx.Settings.Templates.Button")}\n                </button>\n            `),t.on("click",'button[data-fatex="templates"]',()=>CONFIG.FateX.applications.templateSettings.render(!0))})}}Hooks.once("init",(async function(){console.log("FateX | Initializing Fate extended game system"),CONFIG.FateX=u,CONFIG.Actor.entityClass=y,CONFIG.Item.entityClass=A,await class{static async preloadHandlebarsTemplates(){return loadTemplates(["systems/fatex/templates/actor/parts/header.html","systems/fatex/templates/actor/parts/config.html","systems/fatex/templates/actor/parts/copyright.html","systems/fatex/templates/actor/parts/sidebar/artwork.html","systems/fatex/templates/actor/parts/sidebar/stress.html","systems/fatex/templates/actor/parts/tabloid/messages.html","systems/fatex/templates/actor/parts/tabloid/aspects.html","systems/fatex/templates/actor/parts/tabloid/consequences.html","systems/fatex/templates/actor/parts/tabloid/conditions.html","systems/fatex/templates/actor/parts/tabs/skills.html","systems/fatex/templates/actor/parts/tabs/stunts.html","systems/fatex/templates/actor/parts/tabs/extras.html","systems/fatex/templates/actor/parts/tabs/bio.html","systems/fatex/templates/item/parts/layout/item-header.html","systems/fatex/templates/item/parts/layout/item-footer.html","systems/fatex/templates/item/parts/settings/setting-input.html","systems/fatex/templates/item/parts/settings/setting-text.html","systems/fatex/templates/item/parts/settings/setting-rank.html","systems/fatex/templates/item/parts/settings/setting-editor.html","systems/fatex/templates/item/parts/settings/setting-automation-skill-enable.html","systems/fatex/templates/settings/parts/layout/settings-header.html","systems/fatex/templates/settings/parts/layout/settings-footer.html"])}}.preloadHandlebarsTemplates(),class{static registerHelpers(){Handlebars.registerHelper("ifNth",(function(e,t){return(t.data.index+1)%e==0?t.fn(this):t.inverse(this)})),Handlebars.registerHelper("ifEquals",(function(e,t,a){return e===t?a.fn(this):a.inverse(this)})),Handlebars.registerHelper("ifBiggerNull",(function(e,t){return parseInt(e)>0?t.fn(this):t.inverse(this)})),Handlebars.registerHelper("ifNotEquals",(function(e,t,a){return e!==t?a.fn(this):a.inverse(this)})),Handlebars.registerHelper("ifNotEmpty",(function(e,t){return""!==e?t.fn(this):t.inverse(this)})),Handlebars.registerHelper("checkLength",(function(e,t,a){return e.length>=Number(t)?a.fn(this):a.inverse(this)})),Handlebars.registerHelper("default",(function(e,t){return e&&""!==e?e:new Handlebars.SafeString(t)}))}}.registerHelpers(),Actors.unregisterSheet("core",ActorSheet),Items.unregisterSheet("core",ItemSheet),Actors.registerSheet("FateX",k,{types:["character"],makeDefault:!0}),Items.registerSheet("FateX",F,{types:["stress"],makeDefault:!0}),Items.registerSheet("FateX",v,{types:["aspect"],makeDefault:!0}),Items.registerSheet("FateX",S,{types:["consequence"],makeDefault:!0}),Items.registerSheet("FateX",O,{types:["skill"],makeDefault:!0}),Items.registerSheet("FateX",D,{types:["stunt"],makeDefault:!0}),Items.registerSheet("FateX",T,{types:["extra"],makeDefault:!0})})),Hooks.once("ready",(async function(){I.ready()})),I.hooks()}]);